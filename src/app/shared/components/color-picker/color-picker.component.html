<div
  class="color-preview"
  [style.background-color]="color"
  nz-popover
  nzPopoverTrigger="click"
  [(nzPopoverVisible)]="isPopoverVisible"
  [nzPopoverContent]="popoverContentTemplate"
  nzPopoverPlacement="bottom"
  (click)="togglePopoverVisibility()"
></div>

<ng-template #popoverContentTemplate>
  <div class="container">
    <input
      [style.background]="color"
      [(colorPicker)]="color"
      [cpDialogDisplay]="'inline'"
      [cpToggle]="true"
      (colorPickerChange)="onColorPickerChange($event)"
    />

    <div class="preset-colors-wrapper">
      <p>Presets</p>
      <br/>
      <div class="preset-colors">
        <ng-container *ngFor="let token of presetColors">
  
          <ng-container *ngIf="token.value.isPrimary && token.value.tints">
            <ng-container *ngFor="let tint of getColorsByIds(token.value.tints)">
              <ng-container *ngTemplateOutlet="presetColor; context: {$implicit: tint}"></ng-container>
            </ng-container>
          </ng-container>
  
  
          <ng-container *ngIf="token.value.isPrimary">
            <ng-container *ngTemplateOutlet="presetColor; context: {$implicit: token}"></ng-container>
          </ng-container>
  
          <ng-container *ngIf="token.value.isPrimary && token.value.shades">
            <ng-container *ngFor="let shade of getColorsByIds(token.value.shades)">
              <ng-container *ngTemplateOutlet="presetColor; context: {$implicit: shade}"></ng-container>
            </ng-container>
          </ng-container>
  
        </ng-container>
  
      </div>
    </div>

    <ng-template #presetColor let-token>
      <div class="preset-color" (click)="onPresetColorSelect(token.value.color)" nz-tooltip [nzTooltipTitle]="token.name" [style.background]="token.value.color">
      </div>
    </ng-template>
  </div>
</ng-template>